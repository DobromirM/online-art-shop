<%@ include file = "header.jsp" %><%@ page import="java.util.Map"%><%@ page import="shop.Product"%><jsp:useBean id='basket'         scope='session'         class='shop.Basket'          /><%    String empty = request.getParameter("emptyBasket");    if (empty!=null) {        basket.clearBasket();    }        String itemAdd = request.getParameter("addItem");    basket.addItem(itemAdd);        String itemRemove = request.getParameter("removeItem");    basket.removeItem(itemRemove);        String itemChange = request.getParameter("changeQuantity");    if(itemChange != null)    {        String quantity = request.getParameter("quantity");        basket.changeQunatity(itemChange, quantity);        response.sendRedirect("basket.jsp");    }        if(itemAdd != null || itemRemove != null)    {        response.sendRedirect("basket.jsp");    }%><% Map<Product, Integer> items = basket.getItems();    if(items.size() == 0)    {%>        <h1>Your basket is empty!</h1><%    }    else    {%>    <table id='basket'>        <tr>            <th>Item</th>            <th>Price</th>            <th>Quantity</th>            <th>Total Price</th>            <th>Image</th>            <th>Change Quantity</th>            <th>Remove</th>        <%    for (Product p : items.keySet())    {%>        <tr>            <td><%=p.title%></td>            <td><%=p.getPrice()%>&pound;</td>            <td><%=items.get(p)%></td>                        <td><%=basket.getItemTotalString(p)%>&pound;</td>            <td><img src="<%=p.thumbnail%>" /></td>                                    <td>                <form method='post' action=basket.jsp>                   <input type="number" min="1" name="quantity" value="<%=items.get(p)%>" class="quantity-input"/>&emsp;                   <input type="hidden" name="changeQuantity" value="<%=p.PID%>"/>                    <input type='submit' id='change-btn' value='Change'/>                </form>            </td>                <td>                <form method='post' action=basket.jsp>                    <input type="hidden" name="removeItem" value="<%=p.PID%>"/>                    <input type='submit' value='Remove' />                </form>            </td>       </tr>       <%    }%>        </table>    <p id='order-total'>Order total = <%=basket.getTotalString()%>&pound;</p><%    }%>    <%    if ( basket.getTotal() > 0) {%>        <form action="order.jsp" method="post">            <label for="name">Name:            <input type="text" name="name" id="name" required size="20">        </label>        <div class="error" id="nameError">Please enter a valid name!</div>            <br/>            <label for="email">Email:            <input type="email" name="email" id="email" required size="20">        </label>        <div class="error" id="emailError">Please enter a valid email!</div>            <br/>        <br/>            <input type="submit" id="placeOrder" value="Place Order" />        </form>        <form action="basket.jsp" method="get">        <input type="hidden" name="emptyBasket" value="yes">        <input type="submit" value="Empty Basket" />        </form><%    }%></body></html>